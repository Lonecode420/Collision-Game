<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bullet Shooter Game</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      margin: 0;
      overflow: hidden;
      background-color: #1a1a2e;
      font-family: 'Arial', sans-serif;
    }

    #canvas {
      display: block;
      background-color: #0f0f1e;
      cursor: crosshair;
    }

    #hud {
      position: absolute;
      top: 20px;
      left: 20px;
      color: #ffffff;
      font-size: 18px;
      z-index: 10;
      background-color: rgba(0, 0, 0, 0.5);
      padding: 15px;
      border-radius: 8px;
      backdrop-filter: blur(5px);
    }

    #hud div {
      margin-bottom: 8px;
    }

    #score {
      color: #22d3ee;
      font-weight: bold;
    }

    #lives {
      color: #ef4444;
      font-weight: bold;
    }

    #power {
      color: #facc15;
      font-weight: bold;
    }

    #kills {
      color: #22c55e;
      font-weight: bold;
    }

    .wave-warning {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #ef4444;
      font-size: 64px;
      font-weight: bold;
      text-shadow: 0 0 30px #ef4444;
      animation: waveWarning 2s ease-out;
      pointer-events: none;
      z-index: 100;
    }

    @keyframes waveWarning {
      0%, 100% { opacity: 0; }
      50% { opacity: 1; }
    }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  
  <div id="hud">
    <div id="score">Score: 0</div>
    <div id="lives">Lives: 3</div>
    <div id="power">Power: None</div>
    <div id="kills">Kills: 0</div>
  </div>

  <audio id="hitSound" src=""></audio>
  <audio id="powerSound" src=""></audio>
  <audio id="healSound" src=""></audio>

  <script>
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

    canvas.width = innerWidth;
    canvas.height = innerHeight;

    let score = 0;
    let lives = 3;
    let power = null;
    let gameOver = false;
    let kills = 0;
    let screenShake = 0;
    let waveTriggered = false;

    const hitSound = document.getElementById("hitSound");
    const powerSound = document.getElementById("powerSound");
    const healSound = document.getElementById("healSound");

    // ---------------- Mouse Control ----------------
    let mouse = { x: canvas.width / 2, y: canvas.height / 2 };
    canvas.addEventListener("mousemove", e => {
      const rect = canvas.getBoundingClientRect();
      mouse.x = e.clientX - rect.left;
      mouse.y = e.clientY - rect.top;
    });

    // ---------------- Player ----------------
    class Player {
      constructor() {
        this.x = canvas.width / 2;
        this.y = canvas.height / 2;
        this.radius = 15;
      }

      move() {
        const dx = mouse.x - this.x;
        const dy = mouse.y - this.y;
        const dist = Math.hypot(dx, dy);
        if (dist > 1) {
          this.x += dx * 0.12;
          this.y += dy * 0.12;
        }
        this.x = Math.max(this.radius, Math.min(canvas.width - this.radius, this.x));
        this.y = Math.max(this.radius, Math.min(canvas.height - this.radius, this.y));
      }

      draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = power === "shield" ? "#22c55e" : "#22d3ee";
        ctx.fill();
      }
    }

    // ---------------- Enemy ----------------
    class Enemy {
      constructor() {
        this.radius = Math.random() * 10 + 10;
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.vx = (Math.random() - 0.5) * 4;
        this.vy = (Math.random() - 0.5) * 4;
      }

      update() {
        this.x += this.vx;
        this.y += this.vy;
        if (this.x < this.radius || this.x > canvas.width - this.radius) this.vx *= -1;
        if (this.y < this.radius || this.y > canvas.height - this.radius) this.vy *= -1;
        this.draw();
      }

      draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = "#ef4444";
        ctx.fill();
      }
    }

    // ---------------- Power-Up ----------------
    class PowerUp {
      constructor(type) {
        this.type = type;
        this.radius = 10;
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
      }

      draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = this.type === "heal" ? "#22c55e" : "#facc15";
        ctx.fill();
      }
    }

    // ---------------- Bullet ----------------
    class Bullet {
      constructor(x, y, targetX, targetY) {
        this.x = x;
        this.y = y;
        this.radius = 4;
        this.speed = 10;
        const dx = targetX - x;
        const dy = targetY - y;
        const dist = Math.hypot(dx, dy);
        this.vx = (dx / dist) * this.speed;
        this.vy = (dy / dist) * this.speed;
      }

      update() {
        this.x += this.vx;
        this.y += this.vy;
        this.draw();
      }

      draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = "#facc15";
        ctx.fill();
      }

      offscreen() {
        return this.x < 0 || this.x > canvas.width || this.y < 0 || this.y > canvas.height;
      }
    }

    // ---------------- Particle ----------------
    class Particle {
      constructor(x, y, color) {
        this.x = x;
        this.y = y;
        this.radius = Math.random() * 3 + 2;
        this.color = color;
        const angle = Math.random() * 2 * Math.PI;
        const speed = Math.random() * 6 + 2;
        this.vx = Math.cos(angle) * speed;
        this.vy = Math.sin(angle) * speed;
        this.alpha = 1;
        this.decay = Math.random() * 0.02 + 0.015;
      }

      update() {
        this.x += this.vx;
        this.y += this.vy;
        this.alpha -= this.decay;
        this.draw();
      }

      draw() {
        ctx.save();
        ctx.globalAlpha = this.alpha;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = this.color;
        ctx.fill();
        ctx.restore();
      }

      isDead() {
        return this.alpha <= 0;
      }
    }

    // ---------------- Collision ----------------
    function collide(a, b) {
      const dx = a.x - b.x;
      const dy = a.y - b.y;
      return Math.hypot(dx, dy) < a.radius + b.radius;
    }

    // ---------------- Game Variables ----------------
    const player = new Player();
    let enemies = [];
    let powerUps = [];
    let bullets = [];
    let particles = [];

    function spawnEnemies(n) {
      for (let i = 0; i < n; i++) enemies.push(new Enemy());
    }

    spawnEnemies(15);

    // ---------------- Shooting ----------------
    function shoot() {
      if (gameOver) return;
      bullets.push(new Bullet(player.x, player.y, mouse.x, mouse.y));
    }
    canvas.addEventListener("mousedown", shoot);

    // ---------------- HUD ----------------
    function updateHUD() {
      document.getElementById("score").textContent = `Score: ${score}`;
      document.getElementById("lives").textContent = `Lives: ${lives}`;
      document.getElementById("power").textContent = `Power: ${power || "None"}`;
      document.getElementById("kills").textContent = `Kills: ${kills}`;
    }

    function showWaveWarning() {
      const div = document.createElement('div');
      div.className = 'wave-warning';
      div.textContent = '⚠️ ENEMIES INCOMING! ⚠️';
      document.body.appendChild(div);
      setTimeout(() => div.remove(), 2000);
    }

    // ---------------- Main Loop ----------------
    function animate() {
      if (gameOver) {
        ctx.setTransform(1,0,0,1,0,0);
        ctx.fillStyle = "rgba(0,0,0,0.7)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "#fff";
        ctx.font = "40px sans-serif";
        ctx.textAlign = "center";
        ctx.fillText("WASTED", canvas.width / 2, canvas.height / 2);
        ctx.textAlign = "left";
        return;
      }

      // Clear canvas normally
      ctx.setTransform(1,0,0,1,0,0);
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Screen shake offsets
      let shakeX = 0, shakeY = 0;
      if (screenShake > 0) {
        shakeX = (Math.random() - 0.5) * screenShake;
        shakeY = (Math.random() - 0.5) * screenShake;
        screenShake *= 0.9;
        if (screenShake < 0.5) screenShake = 0;
      }

      ctx.save();
      ctx.translate(shakeX, shakeY);

      // Player
      player.move();
      player.draw();

      // Aim line
      ctx.beginPath();
      ctx.moveTo(player.x, player.y);
      ctx.lineTo(mouse.x, mouse.y);
      ctx.strokeStyle = "rgba(250,204,21,0.3)";
      ctx.stroke();

      // Bullets
      for (let i = bullets.length - 1; i >= 0; i--) {
        const b = bullets[i];
        b.update();

        for (let j = enemies.length - 1; j >= 0; j--) {
          if (collide(b, enemies[j])) {
            const colors = ["#ef4444","#facc15","#22c55e","#22d3ee"];
            for (let k = 0; k < 20; k++) {
              const color = colors[Math.floor(Math.random() * colors.length)];
              particles.push(new Particle(enemies[j].x, enemies[j].y, color));
            }
            enemies.splice(j, 1);
            bullets.splice(i, 1);
            score += 50;
            kills++;
            screenShake = 15;
            
            // Trigger wave at exactly 10 kills
            if (kills === 10 && !waveTriggered) {
              waveTriggered = true;
              showWaveWarning();
              setTimeout(() => spawnEnemies(20), 2000);
            }
            
            break;
          }
        }

        if (bullets[i]?.offscreen()) bullets.splice(i, 1);
      }

      // Enemies
      for (let i = enemies.length - 1; i >= 0; i--) {
        const e = enemies[i];
        e.update();

        for (let j = i - 1; j >= 0; j--) {
          if (collide(e, enemies[j])) {
            [e.vx, enemies[j].vx] = [enemies[j].vx, e.vx];
            [e.vy, enemies[j].vy] = [enemies[j].vy, e.vy];
          }
        }

        if (collide(player, e)) {
          if (power !== "shield") {
            lives--;
            hitSound.currentTime = 0;
            hitSound.play();
          }
          enemies.splice(i, 1);
          if (lives <= 0) gameOver = true;
        }
      }

      // Power-ups
      for (let i = powerUps.length - 1; i >= 0; i--) {
        const p = powerUps[i];
        p.draw();
        if (collide(player, p)) {
          if (p.type === "heal" && lives < 5) {
            lives++;
            healSound.currentTime = 0;
            healSound.play();
          } else {
            power = "shield";
            powerSound.currentTime = 0;
            powerSound.play();
            setTimeout(() => power = null, 5000);
          }
          powerUps.splice(i, 1);
        }
      }

      // Particles
      for (let i = particles.length - 1; i >= 0; i--) {
        particles[i].update();
        if (particles[i].isDead()) particles.splice(i, 1);
      }

      ctx.restore();

      score++;
      updateHUD();

      if (score % 600 === 0) enemies.push(new Enemy());
      if (score % 800 === 0) powerUps.push(new PowerUp(Math.random() > 0.5 ? "heal" : "shield"));

      requestAnimationFrame(animate);
    }

    // ---------------- Resize ----------------
    window.addEventListener("resize", () => {
      canvas.width = innerWidth;
      canvas.height = innerHeight;
    });

    animate();
  </script>
</body>
</html>